\section{Related Work}
Related work can be categorized into occlusion management techniques and molecular visualization. We will concentrate the former, according to the focus of this paper.

\subsection{Occlusion Management}
Related occlusion management techniques can be categorized into object centric approaches and transfer function based approaches. In object centric approaches, the geometry or parts of the volume that are obstructing one or more particular objects of interest are (partially) removed. In transfer function based approaches, the user assigns importances to intervals of the volume data values.

\noindent
\textbf{Object Centered Approaches.}
Cutaway and ghosting techniques were first introduced by Feiner \& Seligmann \cite{feiner92} in 1992.
 %as an automated approach for generating illustrations that consider the occlusion of user defined objects. In 2002, Diepstraten et al. \cite{diep02} picked up the technique again and defined a set of rules for computer-based rendering of technical illustrations to achieve a view-dependent transparency model that mimics the ghosting techniques of technical illustrations. They later extended these rules for interactive cutaway illustrations \cite{diep03}.
%Analogous to the cutaways for polygonal representations, Weiskopf et al. \cite{weiskopf03} developed an interactive clipping technique for volume rendering that supports complex clipping geometries. In 2004, Viola et al. \cite{viola2004importance} developed an automated approach for focus \& context visualization for segmented volumetric objects. An assigned object importance determines the visibility priority for the segmented parts of the volume. Contextual information is kept in regions where the context does not occlude the feature of interest. Follow-up work focused on the definition of levels of sparseness and importance compositing for cutaway and ghosting calculations \cite{Viola05}. 
%In 2005, Viola \& Gr{\"o}ller \cite{violasmart05} give an overview of  "smart visibility" techniques. The term describes expressive visualization techniques that smartly uncover the most important features of the displayed data, such as cut-away views, ghosted views, and exploded views. 
Their work inspired several follow-up approaches \cite{diep02, diep03, weiskopf03, viola2004importance, Viola05, Kruger05} that were later summarized in the survey by Viola \& Gr{\"o}ller \cite{violasmart05} under the collective term of "\textit{smart visibility}" techniques. They coined this term to describe expressive visualization techniques that smartly uncover the most important features of the displayed data, i.e., cutaway views, ghosted views, and exploded views. 
%A. Kr{\"u}ger et al. \cite{Kruger05} combined visualization and interaction techniques such as cutaway views, silhouettes and color-coded distances  to improve the spatial perception of feature arrangement for surgical planning.  lymph nodes are emphasized using ghosted views to easily convey their spatial position.

J. Kr{\"u}ger et al. \cite{kruger06} developed a system that applies transparency and shading to enable focus\&context visualization in volume data sets with a simple point\&click interface.
%Li et al. \cite{Li07} developed an approach that allows interactive exploration of complex models, e.g., mechanical or anatomical, that requires the user to rig each part of the respective model. Based on the rigging, the system produces cuts that adhere to a set of rules that were inspired by anatomic and mechanical illustrations. 
Li et al. \cite{Li07} propose a cutaway design based on the geometry of the occluder in contrast to previous approaches that were based on the occludee.
Burns \& Finkelstein \cite{Burns08} applied the concept of importance-driven cutaways for volume data to polygonal models.
%The approach by Burns \& Finkelstein \cite{Burns08} for view dependent cutaways inspired our aperture that is discussed in section XXX. The cutaway shape is determined by the enlarged shape of the focus objects in the depth image. To preserve the information of the cut geometry, they apply shading and contouring/outlining of the cut surfaces, as well as ghosting of the cut geometry contours. 
Lawonn et al. \cite{lawonn16} extend this approach to present a composite technique that combines the visualization of blood flow with the surrounding vessel structures. %The structures visually encode the wall thickness as colored regions in order to preserve important context information. 
Baer et al. \cite{baer11} published a perceptual evaluation of smart visibility techniques for two ghosted view approaches in comparison to semi-transparent approaches. The results clearly favored the ghosted view techniques.
Sigg et al. \cite{sigg12} propose an approach for automatic cutaway box placement with optimized visibility for target features that are specified as degree-of-interest functions during interactive visual analysis of the volume data. Lidal et al. \cite{Lidal12} defined five design principles for cutaway visualization of geological models %. They promote boxes as ideal cutaway shapes for emphasizing the shape and depth of focus features in layered structures, such as geological sediments. Illumination should effectively communicate the shape and spatial ordering inside the cutaway, as well as enhancing relationships between the focus features and the context. They define five design principles
that we discuss in Section \textbf{XXX} in relation to our approach.
A view dependent peel-away approach for volume data was proposed by Birkeland and Viola \cite{birkeland09}. The approach by Diaz et al. \cite{diaz12} preserves the relevant context information in volume clipping by allowing the user to extrude segmented surfaces such as bone structures from the clipping plane.

\noindent
\textbf{Transfer Function Based Approaches.}
The context-preserving volume rendering model \cite{Bruckner05} uses a function of shading intensity, gradient magnitude, distance to the eye point, and previously accumulated opacity to selectively reduce the opacity in less important data regions. Contours of surfaces that would be removed due to opacity, remain visible as the amount of illumination received is taken as a measure whether a point should be visible or not.
Burns et al. \cite{Burns07} propose a multimodal approach that combines CT scan data and real-time ultrasound data. Importance driven shading is used to emphasize features of higher importance that have been revealed through the ghosting.

In his PhD thesis \cite{phd-viola}, Viola presents an optimization strategy for assigning visual mapping to voxels so that segmented objects in the volume are visible as specified by the user. Correa et al. \cite{correa11} used a similar approach for applying visibility directly to voxels, without the notion of segmented objects.
%Correa et al. \cite{correa11} present visibility histograms for specification of transfer functions for volume rendering. 
In contrast to this work, the motivation for our proposed method is to design an interface for authoring cutaway illustrations of mesoscopic multi-molecular data. The properties of such data imply that each bin of our visibility equalizer, representing individual molecular ingredients, can be interacted with to change the properties of the clipping objects applied to the 3D scene. \textbf{[maybe we can cut this justification]}
%The notion of visibility histograms proposed by Correa et al. \cite{correa11} inspired our visibility equalizer metaphor. These histograms represent the distribution of visibility in a volume-rendered image and should help users manage a set of transfer function parameters to maximize the visibility of interesting intervals in the volume.
Ruiz et al. \cite{ruiz11} propose an approach for automatic transfer function optimization by minimizing the informational divergence between a user specified target distribution and the visibility distribution captured from certain viewpoints. 

Transfer function based approaches are well suited for volumetric data that contains segmentable structures, such as the organs or bones in a medical scan. For molecular data this only holds partially true, as some types of molecules do indeed form solid structures that could be made visible with a transfer function (e.g., membranes, nucleus). On the other side, within these structures there is a more noise-like distribution of these molecules that cannot be segmented into solid structures. 
In regard to object centered approaches, (partial) occlusion of individual molecules is not an issue as the data does not contain large singular entities such as polygonal or segmented volumetric objects where each single one has a semantic meaning. Instead there are thousands or hundreds of thousands of instances that belong to a couple of dozen molecule types.
Our approach is therefore fundamentally different from existing occlusion management approaches as it combines principles from object centered and transfer function approaches. 


\subsection{Visualization of Molecular Structures}
%The visualization of the molecular structures in our approach is based on the publicly available cellView \cite{muzic15}. The tool is capable of rendering structures that are comprised of several billions atoms at interactive frame rates in multiple levels of detail.  
Lindow et al. \cite{lindow15} were the first to introduce a fast method for the real-time rendering of large-scale atomic data on consumer grade hardware. They utilize instancing on the GPU to repeat these structures in the scene. For each molecule type, a 3D grid of the atoms is created and stored on the GPU. Falk et al. \cite{falk13} further refined the method with improved depth culling and hierarchical ray casting to achieve faster rendering performance for even larger scenes. 

Other related work is concerned with illustrative molecular visualization. Grottel et al. \cite{grottel12} and Eichelbaum et al. \cite{eichelbaum13} propose ambient occlusion approaches for large molecular scenes in order to improve the depth perception in these complex structures. Parulek et al. \cite{parulek14} propose a continuous level of detail scheme for molecular data that offers gradual shape simplification for distant molecules based on a clustering of the atomic spheres.

In the domain of dedicated mesoscopic scale molecular visualization, our approach is the first to introduce illustrative occlusion management techniques.
