\section{Results}

To showcase the capabilities of our method, we applied it to three different mesoscale molecular scenes. 
We use cellVIEW \cite{muzic15} for the rendering, which is a tool designed to efficiently render large molecular scenes on the GPU and is implemented in Unity3D. 
The different datasets are generated by the domain experts with cellPACK \cite{cellpack}, a modeling tool for procedural generation of large biomolecular structures.
cellPACK summarizes and incorporates the most recent knowledge obtained from structural biology and system biology to generate comprehensive mesoscale models. Based on experimentally obtained data (e.g. data such as proteins structure, concentration and spatial distribution), the tool is able to generate entire models of viruses and cells via a packing method based on collisions constraints.

%The results of the packing with cellPACK is stored in a file and loaded in cellVIEW afterwards.  
%The file generated by cellPACK contains the description of the scene, namely, position, rotation and type of each individual instances.
%In order the load and display the scene, cellVIEW reads the instances information from the file and uploads it on the GPU memory thus allowing fast read accesses from the rendering pipeline.


\begin{figure}[t]
\centering
\subfloat[]{\label{fig:res:islands}\includegraphics[width=0.5\linewidth]{figures/res-islands.eps}}
\subfloat[]{\label{fig:res:myco}\includegraphics[width=0.5\linewidth]{figures/mycoplasma.eps}}

\subfloat[]{\label{fig:res:eq}\includegraphics[width=\linewidth]{figures/eq-s.eps}}
\caption{\label{fig:res:res}
(a) HIV clipped with a plane. 
%Envelope proteins (blue) are reintroduced in the scene. 
Contextual anchoring is used to indicate the proximity of envelope proteins (dark blue) with the lipid membrane (grey)
The dark spots represent shadows projected into interior proteins. 
(b) Mycoplasma mycoides with ribosomes (blue) shown. 
(c) Internal structures of a immature HIV model are shown by several clipping objects. On the left, the visibility equalizer is shown.}
\end{figure}

The first dataset is a model of an HIV particle in blood serum.
Figure \ref{fig:res:islands} shows this dataset clipped with a single plane. 
The contextual anchoring is applied to reintroduce parts of the clipped membrane (grey) around the envelope proteins (blue).
The second dataset is a model of \emph{Mycoplasma mycoides}. 
Figure \ref{fig:res:myco} shows how probabilistic clipping is used to reduce visual clutter to illustrate the positions of the ribosomes (shown in blue) within the cell.
The third dataset, shown in Figure \ref{fig:res:eq} is a model of an immature HIV. 
Here, we applied several clipping objects to reveal the internal structure of the virus. 
The blood serum (blue) has been preserved around the particle using the probabilistic clipping to illustrate how it encloses the HIV particle. 
The visibility equalizer is displayed as well, showing the ratios of visible and clipped-away instances of the individual molecular ingredients. 
The white boxes to the left of each stacked bar are used to mark the given ingredient or compartment as focus.

\begin{figure}[t]
\centering
\subfloat[]{\label{fig:res:gh0}\includegraphics[width=0.5\linewidth]{figures/res-gh0.eps}}
\subfloat[]{\label{fig:res:gh1}\includegraphics[width=0.5\linewidth]{figures/res-gh1.eps}}

\subfloat[]{\label{fig:res:gh2}\includegraphics[width=0.5\linewidth]{figures/res-gh2.eps}}
\subfloat[]{\label{fig:res:gh3}\includegraphics[width=0.5\linewidth]{figures/res-gh3.eps}}
\caption{\label{fig:res:gh}The cutaway molecules are indicated through the ghosting effect. (a) Part of the scene is removed by a clipping plane. (b) The amount of cutaway molecules has been decreased through the probabilistic clipping, which caused some of the cutaway molecules to be reintroduced into the scene. (c) The blood serum (red molecules) are removed by probabilistic clipping in the entire dataset. (d) A falloff function is used to gradually change the influence of the probabilistic clipping.}
\end{figure}

In Figure \ref{fig:res:gh}, we show an example of a single clipping plane used to reduce the concentration of the blood serum molecules, so that the HIV proteins are visible. 
However, to avoid misleading the viewer about the actual concentration of the blood molecules, we render clipped proteins with a ghosting effect. 
It illustrates what the actual concentration is, while the visual clutter caused by the blood serum is significantly reduced. 
Figure \ref{fig:res:gh} illustrates that this can be done in different ways according to the vision of the artist.

The Visibility Equalizer is designed to offer a fast and responsive user experience and therefore it is designed to limit the computational overhead. 
The computation of the object-space clipping, compared to the rendering task performed by cellVIEW, is very light-weight and does not impact the overall performance. The view-space clipping, however, requires more computational work which could impact the responsiveness. 
Therefore, a good strategy is to limit the number of view-space clipping objects, especially for very large scenes with up to several million instances. 
Indeed, for computing occlusion queries, occluders and occludees must be additionally rendered, which adds extra work to the rendering pipeline. 
For this reason, only the bounding spheres of the molecules are rendered rather than their entire structures, which may consist of hundreds or thousands of spheres, in order to guarantee a minimum computational overhead. 
Moreover, the 2D distance transform which is needed for the aperture effect, also require additional computation, but since it is computed in parallel on the GPU. we are able to guarantee a very low computational overhead for this operation too. ** Todo add concrete numbers **

%\begin{figure}[t]
% \centering
%\includegraphics[width=\linewidth]{figures/eq-s.eps} %\caption{\label{fig:res:eq}Mature HIV.}
%\end{figure}


%\begin{figure}[t]
%\centering
%\subfloat[]{\label{fig:res:vsc0}\includegraphics[width=0.245\linewidth]{figures/res-vsc0.eps}}
%\hfill
%\subfloat[]{\label{fig:res:vsc1}\includegraphics[width=0.245\linewidth]{figures/res-vsc1.eps}}
%\hfill
%\subfloat[]{\label{fig:res:vsc2}\includegraphics[width=0.245\linewidth]{figures/res-vsc2.eps}}
%\hfill
%\subfloat[]{\label{fig:res:vsc3}\includegraphics[width=0.245\linewidth]{figures/res-vsc3.eps}}
%\caption{\label{fig:res:gh}View-space clipping.}
%\end{figure}

%\begin{figure*}[t]
%\centering

%\subfloat[]{\label{fig:res:w0}\includegraphics[width=0.25\linewidth]{figures/res-w0.eps}}
%\subfloat[]{\label{fig:res:w1}\includegraphics[width=0.25\linewidth]{figures/res-w1.eps}}
%\subfloat[]{\label{fig:res:w2}\includegraphics[width=0.25\linewidth]{figures/res-w2.eps}}
%\subfloat[]{\label{fig:res:w3}\includegraphics[width=0.25\linewidth]{figures/res-w3.eps}}

%\subfloat[]{\label{fig:res:w4}\includegraphics[width=0.25\linewidth]{figures/res-w4.eps}}
%\subfloat[]{\label{fig:res:w5}\includegraphics[width=0.25\linewidth]{figures/res-w5.eps}}
%\subfloat[]{\label{fig:res:w6}\includegraphics[width=0.25\linewidth]{figures/res-w6.eps}}
%\subfloat[]{\label{fig:res:w7}\includegraphics[width=0.25\linewidth]{figures/res-w7.eps}}
%\caption{\label{fig:res:w}W.}
%\end{figure*}

%\begin{figure}[t]
% \centering
% \includegraphics[width=\linewidth]{figures/results01.eps}
% \caption{\label{fig:results01}An illustration of the HIV virus in the %blood serum utilizing cutaways created with our approach.}
%\end{figure}
